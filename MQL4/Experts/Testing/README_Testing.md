# 🧪 README_Testing.md - EdgeProTrader テスト構成ガイド

このディレクトリは EdgeProTrader における**すべてのテストコードを管理**するルートです。  
テストは以下のように **粒度別・責務別** に整理されており、今後の拡張・保守にも対応しやすい構造になっています。

---

## 📁 フォルダ構成と用途

| フォルダ                     | 内容・用途                                      |
|------------------------------|-------------------------------------------------|
| `Unit/`                      | 各機能コンポーネントの**単体テスト**を格納         |
| ├── `Panel/`                 | 状態管理系（CPanelStateManagerなど）の単体テスト     |
| ├── `Entry/`                 | 発注関連（EntryController, EntryExecutor）のテスト   |
| ├── `Mediator/`              | Mediator層（EntryMediatorなど）の単体接続テスト      |
| ├── `BE/`                    | BE関連ユーティリティ（価格計算など）のテスト         |
| ├── `Trade/`                 | 発注ベース・共通ロジック（OrderExecutorBaseなど）   |
| └── `Common/`                | 共通定義マクロや単機能の補助関数のテスト             |
| `UseCase/`                   | 複数機能連携や状態遷移を含む**UCベースの統合テスト** |
| `Bootstrap/`                 | 初期化・依存接続確認用テスト（主にView接続など）     |
| `Runner/`                    | 複数テストを一括実行する**スイートランナー**を配置    |

---

## 📁 モック・補助コード配置

```plaintext
/Include/TestHelpers/
├── モック定義（Mock_EntryValidator.mqhなど）
├── テスト初期化（TestBootstrap.mqh）
├── テスト共通マクロ（TestMacros.mqh）
└── テストスイート登録・管理（TestSuiteDefs.mqh）
```

---

## 📛 テストファイル命名ルール

### 基本形式

```
Test_<対象名>[_<詳細 or UC名>].mq4
```

### 命名例

| ファイル名                            | 意味／対象                      |
|---------------------------------------|----------------------------------|
| `Test_CPanelState.mq4`                | 状態クラスの基本動作検証           |
| `Test_CPanelState_UseCase.mq4`        | 状態変化ユースケーステスト         |
| `Test_EntryController.mq4`            | 成行発注コントローラー単体テスト     |
| `Test_EntryMediator_Integration.mq4`  | Mediator + Controllerの接続確認     |

> `Test_` プレフィックスは全ファイルで**必須**です。  
> 統一検索／補完／TestRunner対応のためです。

---

## ✅ テスト運用ルール（共通）

- 新規 `.mq4` テスト作成時は、必ず目的に合ったサブフォルダに配置してください
- `.ex4` ファイルは `gitignore` によって除外されます（VC環境でもクリーンに保つため）
- ランナーコード（`TestRunner_*.mq4`）は `Runner/` に集約し、必要に応じて一括起動に利用してください

---

## 🧭 テスト形式（Experts / Scripts）の選定基準

テストコードの作成時は、以下の指針に従って「Experts形式」と「Scripts形式」を使い分けてください：

| 用途                             | 推奨形式       | 説明・目的例                                          |
|----------------------------------|----------------|--------------------------------------------------------|
| 複数回のティック制御が必要な検証 | `Experts/`     | UI連動テスト／状態遷移／OnTick制御を含むユースケースなど |
| 1回限りの初期化確認／構造チェック | `Scripts/`     | Mediator接続・依存注入確認・ログ出力の動作テストなど     |
| 軽量な単体関数の即時検証         | `Scripts/`     | モック関数の動作検証やユーティリティの戻り値チェックなど |

> GPTにテストコードを依頼する際は「Experts形式 or Scripts形式」も明示してください。

---

この `README_Testing.md` は、**テストコードの作成・レビュー・修正時に常に参照すべきドキュメント**です。  
構成変更が発生した場合は必ず本ファイルも更新してください。